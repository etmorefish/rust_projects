# 构建简易中文搜索引擎：Rust 实践指南

⛓️本项目实现原理如下图所示， 过程包括加载文件 -> 读取文本 ->文本预处理 -> 中文分词 -> 构建倒排索引 -> 查询语句中文分词 -> 在倒排索引中匹配出与所有的token并按相关性计算TF-IDF得分 -> 预览文本生成 -> 按照TF-IDF 得分排序 -> 返回展示搜索结果，包括标题、摘要、URL等。

![](https://cdn.jsdelivr.net/gh/etmorefish/picbed@main/chinese_search_engine.png)


>运行截图
![cli search](./assets/2024-04-03%20161850.png)

这个小程序实现了一个中文搜索引擎的基本框架，使用了 `jieba` 分词库来处理中文文本，并利用TF-IDF模型来评估文档中词语的重要性，从而实现对中文文档的搜索。整个搜索引擎的实现分为以下几个主要部分：

1. **文档处理和索引构建**：通过遍历指定目录下的文件，将这些文件的内容转换为纯文本，并添加到搜索引擎中。在添加文档的过程中，利用 `jieba` 对文本进行分词，并构建倒排索引和计算文档中各词的出现频率。

2. **搜索实现**：接收用户输入的关键字，首先对关键字进行分词，然后基于倒排索引找到包含这些关键词的文档，并使用TF-IDF算法计算每个文档对于查询的相关性得分。最后，根据得分对搜索结果进行排序，并输出给用户。

3. **预览文本生成**：为了让搜索结果更加友好，对于每个搜索到的文档，提取与查询词相关的一小段文本作为预览，以帮助用户判断文档内容是否符合自己的需求。

以下是对代码的一些关键点说明和潜在的改进方向：


- 在计算TF-IDF得分时，使用了简化的TF计算方法（词频/文档中所有词的总频数），这是一种有效的方式，但也可以考虑其他词频计算方法以提高搜索质量。

- 在生成预览文本时，尝试找到包含所有查询词的最紧凑文本片段，这对用户来说是非常有用的功能，因为它可以快速提供相关内容的上下文。

- 此脚本使用了纯Rust实现，因此可能在处理大规模数据时性能应该不在话下。对于更大规模的应用，可以考虑使用专门的搜索引擎框架如Elasticsearch，或者使用更高效的数据存储和检索方法。

- 还可以考虑增加更多的用户交互特性，例如支持复杂的查询语法、提供更多的排序和过滤选项等，以提升用户使用体验。

此脚本为构建一个基础的中文搜索引擎提供了一个很好的起点，通过进一步的优化和扩展，可以开发出功能更强大、用户体验更好的搜索工具。

## build and run 
```shell
cargo build --package chinese_search_engine --bin chinese_search_engine

$env:RUST_LOG="info" ;.\target\debug\chinese_search_engine -p C:\Users\maol\Documents\tmp\ChineseSearchEngine\SchoolChinese
```

## Roadmap
实现一个中文搜索引擎是一个复杂且挑战性的任务，涉及到自然语言处理、信息检索、数据结构等多个领域。以下是开发中文搜索引擎可能需要实现的功能和技术的大致路线图（Roadmap）：

### 1. 文本预处理
- [x] **中文分词**：由于中文文本中的词语之间没有明显的分隔符，因此需要进行分词处理，将文本切分为有意义的词语单元。
- [ ] **停用词过滤**：移除文本中的常见但对搜索意义不大的词语，如“的”、“是”等。
- [ ] **词干提取**（可选）：将词语还原到基本形式，例如将动词的过去式还原为一般形式。中文中这一步可能不像英文那样常见或必要。
- [ ] **同义词扩展**（可选）：识别并扩展同义词以增强搜索结果的相关性。

### 2. 索引构建
- [x] **倒排索引**：构建倒排索引（Inverted Index），将文档中出现的每个词语映射到它出现的文档，这是快速检索的关键。
- [ ] **索引优化**：考虑索引压缩、索引分片等技术，以提高存储效率和检索速度。

### 3. 查询处理
- [x] **查询解析**：对用户输入的查询进行分词和预处理。
- [ ] **查询扩展**（可选）：基于同义词等进行查询扩展，以增加搜索的灵活性和覆盖面。
- [x] **相关性打分**：根据一定的算法（如TF- [ ]IDF、BM25等）计算查询词与文档之间的相关性得分。

### 4. 搜索结果排序
- [x] **排序算法**：根据相关性得分对搜索结果进行排序。
- [ ] **个性化和优化**（可选）：根据用户的搜索历史和偏好进行个性化排序，或者通过其他因素（如页面权重、点击率等）对结果进行优化。

### 5. 用户界面
- [ ] **搜索界面设计**：设计用户友好的搜索界面。
- [x] **结果展示**：展示搜索结果，包括标题、摘要、URL等。
- [ ] **高亮显示**：高亮显示搜索结果中的查询词。

### 6. 性能优化
- [ ] **缓存机制**：实现缓存以加速频繁查询的响应速度。
- [ ] **查询优化**：优化查询处理流程，减少响应时间。

### 7. 额外功能
- [ ] **拼写纠错**（可选）：提供查询拼写纠错建议。
- [ ] **自动补全**（可选）：在用户输入查询时提供自动补全建议。
- [ ] **多语言支持**（可选）：支持多语言搜索。

这个路线图只是一个起点，每一步都包含了大量的细节和技术挑战。在实现的过程中，可能还会遇到其他的需求和问题。此外，随着技术的发展和搜索引擎理论的进步，可能还会有新的方法和技术被引入到搜索引擎的开发中来。
